-- 1
select Н_ОЦЕНКИ.ПРИМЕЧАНИЕ, Н_ВЕДОМОСТИ.ИД from Н_ОЦЕНКИ
   right join Н_ВЕДОМОСТИ on Н_ОЦЕНКИ.КОД = Н_ВЕДОМОСТИ.ОЦЕНКА
   where Н_ОЦЕНКИ.КОД > 'зачет' and Н_ВЕДОМОСТИ.ДАТА > '2022-06-08';
-- ведомостей с такой датой нет
-- 2
select Н_ЛЮДИ.ИД, Н_ВЕДОМОСТИ.ЧЛВК_ИД, Н_СЕССИЯ.ДАТА from Н_ЛЮДИ
   right join Н_ВЕДОМОСТИ on Н_ЛЮДИ.ИД = Н_ВЕДОМОСТИ.ЧЛВК_ИД
   right join Н_СЕССИЯ on Н_ЛЮДИ.ИД = Н_СЕССИЯ.ЧЛВК_ИД
   where Н_ЛЮДИ.ФАМИЛИЯ > 'СОКОЛОВ' and Н_ВЕДОМОСТИ.ИД = 1250972 and Н_СЕССИЯ.УЧГОД > '2011/2012';
-- максимальный год --- 2011/2012
-- 3
select count(*) from (
   select count(НАИМЕНОВАНИЕ) from Н_ДИСЦИПЛИНЫ group by НАИМЕНОВАНИЕ
);
-- 4
select Н_ПЛАНЫ.НОМЕР from Н_ПЛАНЫ
   join Н_ГРУППЫ_ПЛАНОВ on Н_ПЛАНЫ.ПЛАН_ИД = Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД
   group by Н_ПЛАНЫ.НОМЕР
   having count(Н_ПЛАНЫ.НОМЕР) > 2;
-- 5
select ГРУППА, AVG(age(Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ)) from Н_УЧЕНИКИ
   join Н_ЛЮДИ on Н_ЛЮДИ.ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
   group by ГРУППА
   having AVG(age(Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ)) = (
      select max(age(Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ)) from Н_ЛЮДИ
         join Н_УЧЕНИКИ on Н_ЛЮДИ.ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
         where Н_УЧЕНИКИ.ГРУППА = '3100'
   );
-- очень странная формулировка

-- select ГРУППА, (
--    select max(age(Н_ЛЮДИ.ДАТА_РОЖДЕНИЯ)) as СРЕДН from Н_ЛЮДИ
--    join Н_УЧЕНИКИ on Н_ЛЮДИ.ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
--    where Н_УЧЕНИКИ.ГРУППА = '3100'
-- ) from Н_УЧЕНИКИ
--    group by ГРУППА;
-- 6
select Н_УЧЕНИКИ.ГРУППА, Н_ЛЮДИ.ИД, Н_ЛЮДИ.ФАМИЛИЯ, Н_ЛЮДИ.ИМЯ, Н_ЛЮДИ.ОТЧЕСТВО, substring(Н_УЧЕНИКИ.ПРИМЕЧАНИЕ from '[A-Za-zА-Яа-яЁё0-9\-]+') as НОМЕР_ПРИКАЗА, Н_УЧЕНИКИ.СОСТОЯНИЕ from Н_ЛЮДИ
   right join Н_УЧЕНИКИ on Н_ЛЮДИ.ИД = Н_УЧЕНИКИ.ЧЛВК_ИД
   where Н_УЧЕНИКИ.ПРИМЕЧАНИЕ like '%Зачислить%' and Н_УЧЕНИКИ.ГРУППА in (
      select Н_УЧЕНИКИ.ГРУППА from Н_ГРУППЫ_ПЛАНОВ
         left join Н_ПЛАНЫ on Н_ГРУППЫ_ПЛАНОВ.ПЛАН_ИД = Н_ПЛАНЫ.ПЛАН_ИД
         left join Н_УЧЕНИКИ on Н_УЧЕНИКИ.ГРУППА = Н_ГРУППЫ_ПЛАНОВ.ГРУППА
         where Н_ПЛАНЫ.КУРС = 1
   );
-- ведомостей для первокурсников нет
-- 7
select count(*) from (
   select ЧЛВК_ИД from Н_ВЕДОМОСТИ
      where ОЦЕНКА = '99' or ТВ_ИД = 2 and ОЦЕНКА in ('5', 'зачет')
      group by ЧЛВК_ИД
);