ORG 0x20
P1:	WORD	-5
P2:	WORD	2
I:	WORD	17
R1:	WORD	0
R2:	WORD	0
START:	LD	$P2
	ST	$R2
	CLA
	ST	$R1
	LD	#0x45
	ST	$SHIFTFUNC
	LD	$P1
	BPL	GOTOPOS 
	CALL	ITERNEG
	JUMP	CORRSTEP
GOTOPOS:	CALL	ITERPOS
CORRSTEP:	CALL	CORRECTRES
	HLT
ITERPOS:	LOOP	$I
	JUMP	BITACTPOS
	RET
ITERNEG:	LOOP	$I
	JUMP	BITACTNEG
	RET
BITACTPOS:	LD	$R2
	AND	#1
	BEQ	SKIPADDPOS
	CALL	ADDTOSPP
SKIPADDPOS:	CALL	SHIFTPOS
	JUMP	ITERPOS
BITACTNEG:	LD	$R2
	AND	#1
	BEQ	SKIPADDNEG
	CALL	ADDTOSPP
SKIPADDNEG:	WORD	0xD801	; CALL (1)
	JUMP	ITERNEG
SHIFTFUNC:	WORD	0x45
SHIFTPOS:	LD	$R1
	CLC
	JUMP	SHIFT
SHIFTNEG:	LD	$R1
	CLC
	CMC
SHIFT:	ROR
	ST	$R1
	LD	$R2
	ROR
	ST	$R2
	RET
ADDTOSPP:	LD	#0x48
	ST	$SHIFTFUNC
	LD	$R1
	ADD	$P1
	ST	$R1
	RET
CORRECTRES:	LD	$P2
	BPL	SKIPCORR
	LD	$R1
	SUB	$P1
	ST	$R1
SKIPCORR:	RET
